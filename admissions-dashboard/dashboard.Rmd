---
title: "Education Analytics Dashboard"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
    orientation: columns
    vertical_layout: fill
runtime: shiny
---

```{r setup, include=FALSE}
#setwd("/home/walling/dev/git/oncourse/admissions-dashboard")
library(flexdashboard)
library(ggplot2)
library(gridExtra)
options(useHTTPS=FALSE)
load(file="model_reduced.Rdata")
model = model_reduced
#source("simulated_data.R")
#load(file="model.Rdata")
```

Admissions Explorer
=============================
Column {.sidebar}
-----------------------------------------------------------------------

This tool allows you to explore the impact of your high school performance on the probability of being
admitted to a Texas public university.


```{r, eval=T}

# Reset lables of grad type for display, actual values/levels must still match what was used in creating the models.
gradtype_levels = levels(gradtype_fct)
gradtype_choices = c("Minimum/IEP"=gradtype_levels[1], "Recommended"=gradtype_levels[2], "Distinguished"=gradtype_levels[3])

selectInput("gradtype_fct", label = "HS Graduation Type",
            choices=gradtype_choices, selected = gradtype_levels[2])

sliderInput("gpa", label = "HS GPA",
            min = 0.0, max = 4.0, value = 3.0, step = 0.1)

'Here is a link'

sliderInput("act", label = "ACT Score",
            min = 10, max = 36, value = 23, step = 1)

sliderInput("num_adv_courses", label = "# of AP Course",
            min = 0, max = 10, value = 3, step = 1)

sliderInput("num_dual_credit", label = "# of Dual Credit Courses",
            min = 0, max = 10, value = 2, step = 1)

checkboxGroupInput("schools", label='Schools',
            choices=sort(levels(school_fct)), selected=c('The University of Texas at Austin', 'Texas Tech University'))
```

Column
-----------------------------------------------------------------------

### Output

```{r, eval=T}
renderPlot({
    # Will create a prediction for each selected school
    selected_schools <- input$schools
    pred_data <- data.frame(school_fct=selected_schools,
                            gradtype_fct=input$gradtype_fct,
                            num_adv_courses=input$num_adv_courses,
                            num_dual_credit=input$num_dual_credit,
                            gpa=input$gpa,
                            act=input$act)
    predictions <- predict(model, newdata=pred_data, type='response')
    
    # TODO: Replace with more interesting plot, ex. ggplot2
    #plot(predictions)
    ggplot(pred_data, aes(x=school_fct, y=predictions)) +
      geom_bar(stat="identity", aes(fill=school_fct)) +
      ylim(0,1)
  })
```